from plenumhub import Sphere, Rule, Interpreter

def test_pop_and_merge():
    it = Interpreter()
    s = Sphere(id='s0', T=['text'], M={'text':'hi'}, E=0.0)
    it.add_sphere(s)
    r = Rule(name='noop', in_mod='text', out_mod='text', epsilon=0.0)
    it.register_rule(r)
    out = it.pop('s0','s1',['noop'])
    assert out.M['text'] == 'hi'
    merged = it.merge('s0','s1','s2')
    assert merged.id == 's2'
